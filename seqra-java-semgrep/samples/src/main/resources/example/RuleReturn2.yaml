rules:
  - id: java.return.chained
    languages:
      - java
    severity: ERROR
    message: Return
    patterns:
      - pattern: |
          return $X;
      - pattern-inside: |
          $X = src();
          ...
      - pattern-not-inside: |
          ...
          clean($X);
          ...