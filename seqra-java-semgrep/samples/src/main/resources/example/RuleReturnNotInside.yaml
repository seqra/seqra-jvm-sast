rules:
  - id: java.return.not-inside
    languages:
      - java
    severity: ERROR
    message: Return a value that should not be inside a sanitizer block
    metadata:
      cwe: CWE-79
      license: MIT
      shortDescription: Return from source not inside sanitizer
    patterns:
      - pattern: |
          $RET = $SOURCE.mkType2().mkType3().mkType1();
      - pattern-not-inside: |
          ...
          sanitize($RET);
      - pattern-inside: |
          $RETURNTYPE $METHOD(..., CustomType1 $SOURCE,...) {
            ...
            return $RET;
          }